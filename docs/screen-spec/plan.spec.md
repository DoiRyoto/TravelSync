# 旅行プランページ仕様

この画面は、ユーザーが入力した条件に基づいて自動生成された旅行プランを表示・編集するためのページです。ユーザーは日程ごとの観光地をドラッグアンドドロップで順序変更したり、観光地を別の候補に変更したり、移動手段の詳細を確認できます。プラン変更後はルート再検索により最適化された移動手段を再計算できます。

# 画面仕様

## デフォルト画面
PC: https://www.figma.com/design/6oxJdP68XTogCZLPg5t0Ne/Playground?node-id=61-2638&t=N3IFV2cAuHa2s4V0-11
SP: https://www.figma.com/design/6oxJdP68XTogCZLPg5t0Ne/Playground?node-id=61-2995&t=N3IFV2cAuHa2s4V0-11

## 入力項目一覧

| 項目名 | 必須 | 種別 | デフォルト | 文字種 | 文字数 | 説明 |
| -------- | ----------- | ------ | -------------- | -------- | -------- | ------ |
| searchQuery | 任意 | テキスト | 空文字 | 自由文字 | - | 観光地変更ダイアログ内の検索キーワード |

## バリデーション一覧

| エラー概要 | エラーメッセージ | エラー原因 |
| ------------ | ------------------ | ------------ |

## 備考

| 項目 | 内容 |
| ------ | ------ |
| ドラッグアンドドロップ | @dnd-kit/coreを使用した観光地の順序変更機能 |
| 移動手段詳細 | 各移動手段は折りたたみ表示で詳細情報を確認可能 |
| ルート最適化 | プラン変更後にルート再検索で移動時間・コストを再計算 |
| 観光地変更 | モーダルダイアログで代替観光地を検索・選択可能 |

## 使用API

| 項目名 | 機能 |
| ------------ | ---------- |

## エラー／例外ケース

| エラー概要 | エラーメッセージ | エラー原因 |
| ------------ | ------------------ | ------------ |

## 権限による表示制御

| 権限 | アクセス可能URL | 表示内容 |
| -------- | ----------------- | ---------- |
| 全ユーザー | /plan/[countryId] | 全機能利用可能 |

## 状態／シナリオ別表示仕様

| 状態／シナリオ | 条件 | Figmaのフレームのリンク | 備考 |
| -------------- | ------------------------------ | ------------------------------------ | ------------------------ |
| ローディング状態 | loading=true | [Figmaのフレームのリンク] | "プランを読み込み中..."表示、スピナーアニメーション |
| エラー状態 | error!=null | [Figmaのフレームのリンク] | エラーアラート表示、ホームに戻るボタン |
| 通常表示状態 | travelPlan存在、loading=false | [Figmaのフレームのリンク] | 旅行プラン表示、全機能利用可能 |
| ルート検索中状態 | isRouteSearching=true | [Figmaのフレームのリンク] | "ルート検索中..."ボタン、スピナーアニメーション |
| 変更なし状態 | hasChanges=false | [Figmaのフレームのリンク] | ルート再検索ボタンが無効化 |
| 観光地変更ダイアログ | isSpotDialogOpen=true | [Figmaのフレームのリンク] | モーダルダイアログで観光地検索・選択 |
| 移動手段詳細表示 | transportationOpenStates[id]=true | [Figmaのフレームのリンク] | 移動手段の時間・コスト・詳細表示 |

# 画面遷移元

| 権限 | 遷移元 | アクション |
| -------- | -------- | ------------ |
| 全ユーザー | ホームページ | 旅行プラン生成ボタンクリック後の自動遷移 |
| 全ユーザー | 直接アクセス | URL直接入力（/plan/[国ID]） |